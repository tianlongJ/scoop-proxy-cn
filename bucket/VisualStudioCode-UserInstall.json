{
  "##": "Download url https:code.visualstudio.comdownload#",
  "version": "1.97.2",
  "description": "Visual Studio Code (User). is a lightweight but powerful source code editor.",
  "homepage": "https:code.visualstudio.com",
  "license": {
    "identifier": "Freeware",
    "url": "https:code.visualstudio.comLicense"
  },
  "changelog": "https:code.visualstudio.comupdatesv1_97",
  "architecture": {
    "64bit": {
      "url": "https:code.visualstudio.comshadownload?build=stable&os=win32-x64-user#setup.exe",
      "hash": "daabe6898fcca63afae8c69436df1f49687c390d2c7b2eb6ac6b3e9bc5821f39"
    }
  },
  "pre_install": [
    "$processname = \"Code\"",
    "$process = Get-Process $processname -ErrorAction SilentlyContinue",
    "if ($process) {",
    "   $process.CloseMainWindow()",
    "   Start-Sleep -Seconds 5",
    "   if (!$process.HasExited) {",
    "       Start-Sleep -Seconds 25",
    "       $process | Stop-Process -Force",
    "   }",
    "}"
  ],
  "installer": {
    "script": [
      "$programname = \"Microsoft Visual Studio Code (User)*\"",
      "$regPath = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{771FD6B0-FA20-440A-A002-3B3BAC16DC50}_is1\"",
      "if((Get-ItemProperty -LiteralPath \"$regPath\").DisplayVersion -lt [Version]\"$version\")",
      "{",
      "   &\"$dir\\setup.exe\" VERYSILENT MERGETASKS=!runcode,!desktopicon,!quicklaunchicon,addcontextmenufiles,addcontextmenufolders,associatewithfiles,addtopath | Out-Null",
      "   if((Get-ItemProperty -LiteralPath \"$regPath\").DisplayVersion -lt [Version]\"$version\")",
      "   {",
      "       exit 1",
      "   }",
      "}",
      "if (Test-Path -Path \"$dir\\setup.exe\") { Remove-Item \"$dir\\setup.exe\" -Force }"
    ]
  },
  "checkver": {
    "github": "https:github.commicrosoftvscode"
  },
  "autoupdate": {
    "changelog": "https:code.visualstudio.comupdatesv$majorVersion_$minorVersion",
    "architecture": {
      "64bit": {
        "url": "https:code.visualstudio.comshadownload?build=stable&os=win32-x64-user#setup.exe"
      }
    }
  }
}